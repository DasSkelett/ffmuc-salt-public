{%- set interface_details = salt['pillar.get']('netbox:interfaces:' ~ interface) %}
#
# {{ interface }} / {{ desc }}
#

[Match]
Name={{ interface }}

[Network]
{%- if interface_details['tagged_vlans'] is not none %}
{%- for vlan in interface_details['tagged_vlans'] %}
VLAN={{ vlan['vid'] }}
{%- endfor %}
{%- endif %}
{%- for ipaddress in ipaddresses %}
Address={{ ipaddress['address'] }}
{%- endfor %}
DNS=1.1.1.1

{%- if interface in gateway %}
# We install the route provided for the site with a low metric
{%- for gw in gateway[interface] %}
[Route]
Gateway={{ gw }}
Destination=0.0.0.0/0
Metric=1024
{%- endfor %}
{%- endif %}
