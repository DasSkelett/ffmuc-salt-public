{%- set server_pub_key = salt.file.read('/etc/wireguard/keys/server-pub.key') %}
{%- set client_priv_key = salt.file.read('/etc/wireguard/keys/client-' ~ client_name ~  '-priv.key') %}
{%- set port = 51820 + network_id  -%}
# Generated by SaltStack

[Interface]
PrivateKey = {{ client_priv_key }}

[Peer]
PublicKey = {{ server_pub_key }}
Endpoint = {{ grains['id'] | regex_replace('in\.ffmuc\.net','ext.ffmuc.net') }}:{{ port }}
AllowedIPs = 0.0.0.0/0,::/0
PersistentKeepalive = 15
